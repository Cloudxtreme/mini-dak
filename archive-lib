#!/bin/bash
#
# archive-lib
#
# Requires: procmail (formail)

# Import configuration

. archive.conf

# Canonicalize directories

queue_dir=$archive_dir/$queue_dir
pool_dir=$archive_dir/$pool_dir
incoming_dir=$archive_dir/$incoming_dir
indices_dir=$archive_dir/$indices_dir
dists_dir=$archive_dir/$dists_dir

accepted_dir=$queue_dir/accepted
rejected_dir=$queue_dir/rejected
unchecked_dir=$queue_dir/unchecked
byhand_dir=$queue_dir/byhand

######
# file input functions

fetch_maintainer ()
{
  formail -xMaintainer:
}

fetch_source_package ()
{
  formail -xSource:
}

fetch_distribution ()
{
  formail -xDistribution:
}

fetch_files ()
{
  formail -xFiles: | cut -d' ' -f6
}

fetch_md5sums ()
{
  formail -xFiles: | cut -d' ' -f2,6 | sed -e 's/ /  /'
}

secure_files ()
{
  local changes=$1
  local files=`fetch_files < $changes`

  for file in $files; do
    echo $(basename `readlink -f $file`)
  done
}

